<nz-card class="permisos-container">
  <div class="permisos-header">
    <h5 nz-typography class="section-title">Super Admin</h5>
    <p nz-typography nzType="secondary">Acceso completo del sistema</p>
    
    <div class="permisos-tabs">
      <nz-radio-group [(ngModel)]="activeTab" (ngModelChange)="cambiarTab($event)">
        <label nz-radio-button nzValue="permisos">Permisos</label>
        <label nz-radio-button nzValue="unidades">Unidades Educativas</label>
      </nz-radio-group>
    </div>
  </div>

  <div *ngIf="activeTab === 'permisos'">
    <div class="permisos-filters">
      <nz-input-group nzSearch [nzSuffix]="suffixIconButton">
        <input type="text" nz-input placeholder="Buscar por descriptor" [(ngModel)]="searchValue" />
      </nz-input-group>
      <ng-template #suffixIconButton>
        <button nz-button nzType="primary" nzSearch><i nz-icon nzType="search"></i></button>
      </ng-template>

      <nz-space>
        <nz-tag *nzSpaceItem nzMode="checkable" [nzChecked]="filterActivo" (nzCheckedChange)="filterActivo = $event">
          Solo activos
        </nz-tag>
      </nz-space>
      
      <button nz-button nzType="primary" (click)="showModal()">
        <i nz-icon nzType="plus"></i> Nuevo Permiso
      </button>
    </div>

    <nz-table #permisosTable [nzData]="filteredPermisos" nzSize="small" nzBordered>
      <thead>
        <tr class="header-row">
          <th class="header-cell" nzWidth="80px">Nro Permiso</th>
          <th class="header-cell">Descriptor</th>
          <th class="header-cell" nzWidth="120px">Admio</th>
          <th class="header-cell" nzWidth="120px">Estado</th>
          <th class="header-cell" nzWidth="100px">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of permisosTable.data">
          <td>{{ data.id }}</td>
          <td>{{ data.descriptor }}</td>
          <td>
            <nz-tag [nzColor]="data.admio ? 'processing' : 'default'">
              {{ data.admio ? 'ADMINISTRAR' : 'CONSULTA' }}
            </nz-tag>
          </td>
          <td>
            <nz-switch 
              [ngModel]="data.activo" 
              (ngModelChange)="cambiarEstadoPermiso(data)"
              [nzCheckedChildren]="checkedTemplate" 
              [nzUnCheckedChildren]="unCheckedTemplate">
            </nz-switch>
            <ng-template #checkedTemplate><i nz-icon nzType="check"></i></ng-template>
            <ng-template #unCheckedTemplate><i nz-icon nzType="close"></i></ng-template>
          </td>
          <td>
            <nz-space nzSize="small">
              <button *nzSpaceItem nz-button nzType="default" nzSize="small" nzShape="circle" nz-tooltip="Editar">
                <i nz-icon nzType="edit"></i>
              </button>
              <button *nzSpaceItem nz-button nzType="default" nzSize="small" nzShape="circle" nzDanger nz-tooltip="Eliminar">
                <i nz-icon nzType="delete"></i>
              </button>
            </nz-space>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>

  <div *ngIf="activeTab === 'unidades'">
    <div class="permisos-filters">
      <nz-input-group nzSearch [nzSuffix]="suffixIconButton">
        <input type="text" nz-input placeholder="Buscar por nombre" [(ngModel)]="searchValue" />
      </nz-input-group>
      <ng-template #suffixIconButton>
        <button nz-button nzType="primary" nzSearch><i nz-icon nzType="search"></i></button>
      </ng-template>
    </div>

    <nz-table #unidadesTable [nzData]="filteredUnidades" nzSize="small" nzBordered>
      <thead>
        <tr class="header-row">
          <th class="header-cell">Unidad Educativa</th>
          <th class="header-cell" nzWidth="120px">Permisos</th>
          <th class="header-cell" nzWidth="120px">Estado</th>
          <th class="header-cell" nzWidth="180px">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of unidadesTable.data">
          <td>{{ data.nombre }}</td>
          <td>{{ data.permisos }} permisos</td>
          <td>
            <nz-tag [nzColor]="data.estado === 'Activo' ? 'success' : 'error'">
              {{ data.estado }}
            </nz-tag>
          </td>
          <td>
            <nz-space nzSize="small">
              <button *nzSpaceItem nz-button nzType="primary" nzSize="small" nz-tooltip="Administrar permisos">
                <i nz-icon nzType="safety-certificate"></i> Permisos
              </button>
              <button *nzSpaceItem nz-button nzType="default" nzSize="small" nz-tooltip="Editar">
                <i nz-icon nzType="edit"></i>
              </button>
            </nz-space>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>
</nz-card>

<nz-modal 
  [(nzVisible)]="isVisible" 
  nzTitle="Nuevo Permiso" 
  (nzOnCancel)="handleCancel()" 
  (nzOnOk)="handleOk()"
>
  <!-- [nzConfirmLoading]="isConfirmLoading" -->
  <form nz-form [formGroup]="permisoForm">
    <nz-form-item>
      <nz-form-label nzRequired>Descriptor</nz-form-label>
      <nz-form-control>
        <input nz-input formControlName="descriptor" placeholder="Ingrese el descriptor del permiso" />
      </nz-form-control>
    </nz-form-item>
    
    <nz-form-item>
      <nz-form-label>Tipo</nz-form-label>
      <nz-form-control>
        <nz-switch 
          formControlName="admio" 
          nzCheckedChildren="ADMINISTRAR" 
          nzUnCheckedChildren="CONSULTA">
        </nz-switch>
      </nz-form-control>
    </nz-form-item>
    
    <nz-form-item>
      <nz-form-label>Estado</nz-form-label>
      <nz-form-control>
        <nz-switch formControlName="activo" nzCheckedChildren="Activo" nzUnCheckedChildren="Inactivo" ></nz-switch>
<!-- [nzDefaultChecked]="true" -->
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-modal>